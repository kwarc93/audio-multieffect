/*
 * vocoder.hpp
 *
 *  Created on: 24 sty 2024
 *      Author: kwarc
 */

#ifndef MODEL_VOCODER_VOCODER_HPP_
#define MODEL_VOCODER_VOCODER_HPP_

#include "app/model/effect_interface.hpp"

#include <array>

#include <libs/audio_dsp.hpp>

#define VOCODER_ALG_FFT

namespace mfx
{

class vocoder : public effect
{
public:
    vocoder (float clarity = 0.7f, unsigned channels = 64, vocoder_attr::controls::mode_type mode = vocoder_attr::controls::mode_type::modern);
    virtual ~vocoder ();

    void process(const dsp_input &in, dsp_output &out) override;
    const effect_specific_attributes get_specific_attributes(void) const override;

    void set_mode(vocoder_attr::controls::mode_type mode);
    void set_clarity(float clarity);
    void set_channels(unsigned ch_num);
    void hold(bool state);

private:
    constexpr static unsigned bands {16};

#ifndef VOCODER_ALG_FFT
    class filter_bank
    {
    public:
        filter_bank()
        {
            for (unsigned i = 0; i < this->bands; i++)
                this->bandpass_filters[i].set_coeffs(this->bandpass_coeffs[i]);

            for (auto &&f : this->lowpass_filters)
                f.set_coeffs(this->lowpass_coeffs);
        }

        void bandpass(uint32_t band, const float *in, float *out, uint32_t samples)
        {
            this->bandpass_filters[band].process(in, out, samples);
        }

        void lowpass(uint32_t band, const float *in, float *out, uint32_t samples)
        {
            this->lowpass_filters[band].process(in, out, samples);
        }

        static constexpr uint32_t bands {16};

    private:
        /* Lowpass filter (RMS envelope) */
        static constexpr std::array<float, 5> lowpass_coeffs { 0, 0, 1, 1.98f, -0.9801f};

        /* Band: 1: 50 - 159[Hz] */
        static constexpr std::array<float, 10> bandpass_1_coeffs
        {
            0.0000253908432510,0.0000507816865021,0.0000253908432510,1.9930766231408228,-0.9934212036678660,
            1.0000000000000000,-2.0000000000000000,1.0000000000000000,1.9973489469544987,-0.9974025505379704
        };
        /* Band: 2: 159 - 200.327[Hz] */
        static constexpr std::array<float, 10> bandpass_2_coeffs
        {
            0.0000036604848021,0.0000073209696041,0.0000036604848021,1.9974483728787567,-0.9981010284516609,
            1.0000000000000000,-2.0000000000000000,1.0000000000000000,1.9979577333868821,-0.9984132970629739
        };
        /* Band: 3: 200.327 - 252.397[Hz] */
        static constexpr std::array<float, 10> bandpass_3_coeffs
        {
            0.0000058080276524,0.0000116160553049,0.0000058080276524,1.9965723217555342,-0.9976080598208837,
            1.0000000000000000,-2.0000000000000000,1.0000000000000000,1.9972782757110359,-0.9980012730977980
        };
        /* Band: 4: 252.397 - 318[Hz] */
        static constexpr std::array<float, 10> bandpass_4_coeffs
        {
            0.0000092144145305,0.0000184288290610,0.0000092144145305,1.9953437891741053,-0.9969873281821122,
            1.0000000000000000,-2.0000000000000000,1.0000000000000000,1.9963350296156561,-0.9974823786303491
        };
        /* Band: 5: 318 - 400.655[Hz] */
        static constexpr std::array<float, 10> bandpass_5_coeffs
        {
            0.0000146164742441,0.0000292329484881,0.0000146164742441,1.9935981231422533,-0.9962058517209192,
            1.0000000000000000,-2.0000000000000000,1.0000000000000000,1.9950083517822803,-0.9968289589364828
        };
        /* Band: 6: 400.655 - 504.794[Hz] */
        static constexpr std::array<float, 10> bandpass_6_coeffs
        {
            0.0000231812433704,0.0000463624867408,0.0000231812433704,1.9910852656256894,-0.9952222181356506,
            1.0000000000000000,-2.0000000000000000,1.0000000000000000,1.9931176448081189,-0.9960062356874733
        };
        /* Band: 7: 504.794 - 636[Hz] */
        static constexpr std::array<float, 10> bandpass_7_coeffs
        {
            0.0000367560816023,0.0000735121632046,0.0000367560816023,1.9874228634263347,-0.9939844859748729,
            1.0000000000000000,-2.0000000000000000,1.0000000000000000,1.9903881474023759,-0.9949704853571905
        };
        /* Band: 8: 636 - 801.31[Hz] */
        static constexpr std::array<float, 10> bandpass_8_coeffs
        {
            0.0000582631419384,0.0001165262838768,0.0000582631419384,1.9820230986587217,-0.9924276038776757,
            1.0000000000000000,-2.0000000000000000,1.0000000000000000,1.9863990979473878,-0.9936667539469665
        };
        /* Band: 9: 801.31 - 1009.59[Hz] */
        static constexpr std::array<float, 10> bandpass_9_coeffs
        {
            0.0000923204661870,0.0001846409323741,0.0000923204661870,1.9739786474086038,-0.9904702685411013,
            1.0000000000000000,-2.0000000000000000,1.0000000000000000,1.9805028189210709,-0.9920259854785439
        };
        /* Band: 10: 1009.59 - 1272[Hz] */
        static constexpr std::array<float, 10> bandpass_10_coeffs
        {
            0.0001462178381960,0.0002924356763920,0.0001462178381960,1.9618855016501633,-0.9880111575615337,
            1.0000000000000000,-2.0000000000000000,1.0000000000000000,1.9716985971374403,-0.9899614008938247
        };
        /* Band: 11: 1272 - 1602.62[Hz] */
        static constexpr std::array<float, 10> bandpass_11_coeffs
        {
            0.0002314459555137,0.0004628919110275,0.0002314459555137,1.9435693549545308,-0.9849245224883534,
            1.0000000000000000,-2.0000000000000000,1.0000000000000000,1.9584368118625362,-0.9873638994453899
        };
        /* Band: 12: 1602.62 - 2019.17[Hz] */
        static constexpr std::array<float, 10> bandpass_12_coeffs
        {
            0.0003660846695791,0.0007321693391582,0.0003660846695791,1.9156674320547964,-0.9810552459278270,
            1.0000000000000000,-2.0000000000000000,1.0000000000000000,1.9383167623387507,-0.9840961441685229
        };
        /* Band: 13: 2019.17 - 2544[Hz] */
        static constexpr std::array<float, 10> bandpass_13_coeffs
        {
            0.0005785173244832,0.0011570346489664,0.0005785173244832,1.8730004803740419,-0.9762137248213886,
            1.0000000000000000,-2.0000000000000000,1.0000000000000000,1.9076258509221240,-0.9799847896282214
        };
        /* Band: 14: 2544 - 3205.24[Hz] */
        static constexpr std::array<float, 10> bandpass_14_coeffs
        {
            0.0009131773564504,0.0018263547129008,0.0009131773564504,1.8076573959746691,-0.9701714833440057,
            1.0000000000000000,-2.0000000000000000,1.0000000000000000,1.8606504612657724,-0.9748099114933489
        };
        /* Band: 15: 3205.24 - 4038.35[Hz] */
        static constexpr std::array<float, 10> bandpass_15_coeffs
        {
            0.0014393812914308,0.0028787625828615,0.0014393812914308,1.7077305429645615,-0.9626595461894795,
            1.0000000000000000,-2.0000000000000000,1.0000000000000000,1.7886798312872059,-0.9682898711273570
        };
        /* Band: 16: 4038.35 - 5088[Hz] */
        static constexpr std::array<float, 10> bandpass_16_coeffs
        {
            0.0022647967131630,0.0045295934263260,0.0022647967131630,1.5557447797284123,-0.9533739999571791,
            1.0000000000000000,-2.0000000000000000,1.0000000000000000,1.6786533451550325,-0.9600580330493774
        };

        static constexpr std::array<std::array<float, 10>, bands> bandpass_coeffs
        {
            bandpass_1_coeffs,
            bandpass_2_coeffs,
            bandpass_3_coeffs,
            bandpass_4_coeffs,
            bandpass_5_coeffs,
            bandpass_6_coeffs,
            bandpass_7_coeffs,
            bandpass_8_coeffs,
            bandpass_9_coeffs,
            bandpass_10_coeffs,
            bandpass_11_coeffs,
            bandpass_12_coeffs,
            bandpass_13_coeffs,
            bandpass_14_coeffs,
            bandpass_15_coeffs,
            bandpass_16_coeffs,
        };

        std::array<libs::adsp::iir_biquad<2>, bands> bandpass_filters;
        std::array<libs::adsp::iir_biquad<1>, bands> lowpass_filters;
    };

    /* Lowpass filter (RMS envelope) */
    static constexpr std::array<float, 5> lowpass_coeffs { 0, 0, 1, 1.98f, -0.9801f};

    /* Highpass filter, fc = 5088Hz*/
    static constexpr std::array<float, 10> highpass_coeffs
    {
        0.2529996995574256,-0.5059993991148511,0.2529996995574256,0.3334617277963257,-0.3786640264144165,
        1.0000000000000000,-2.0000000000000000,1.0000000000000000,1.4486195475185251,-0.8910563941509072
    };

    libs::adsp::iir_biquad<2> highpass_filter;
    std::array<float, filter_bank::bands> modulator_hold;
    std::array<float, mfx::config::dsp_vector_size> carrier_env_buf, carrier_bp_buf, modulator_env_buf;
    filter_bank carrier_fb, modulator_fb;
#else
    constexpr static unsigned window_size {1024};

    /* Hanning window for 7/8 overlap */
    constexpr static std::array<float, 1024> window_hann
    {
        0.0000000000000000,    0.0000023530896749,    0.0000094122701069,
        0.0000211772755221,    0.0000376476629745,    0.0000588228123634,
        0.0000847019264563,    0.0001152840309193,    0.0001505679743534,
        0.0001905524283382,    0.0002352358874814,    0.0002846166694760,
        0.0003386929151637,    0.0003974625886043,    0.0004609234771527,
        0.0005290731915425,    0.0006019091659754,    0.0006794286582181,
        0.0007616287497055,    0.0008485063456507,    0.0009400581751613,
        0.0010362807913626,    0.0011371705715275,    0.0012427237172129,
        0.0013529362544024,    0.0014678040336563,    0.0015873227302677,
        0.0017114878444252,    0.0018402947013823,    0.0019737384516339,
        0.0021118140710980,    0.0022545163613056,    0.0024018399495962,
        0.0025537792893199,    0.0027103286600465,    0.0028714821677807,
        0.0030372337451839,    0.0032075771518030,    0.0033825059743050,
        0.0035620136267185,    0.0037460933506820,    0.0039347382156978,
        0.0041279411193935,    0.0043256947877888,    0.0045279917755700,
        0.0047348244663698,    0.0049461850730543,    0.0051620656380161,
        0.0053824580334739,    0.0056073539617787,    0.0058367449557258,
        0.0060706223788740,    0.0063089774258704,    0.0065518011227824,
        0.0067990843274348,    0.0070508177297550,    0.0073069918521224,
        0.0075675970497263,    0.0078326235109281,    0.0081020612576315,
        0.0083759001456576,    0.0086541298651270,    0.0089367399408481,
        0.0092237197327111,    0.0095150584360892,    0.0098107450822447,
        0.0101107685387428,    0.0104151175098697,    0.0107237805370587,
        0.0110367459993213,    0.0113540021136847,    0.0116755369356356,
        0.0120013383595696,    0.0123313941192472,    0.0126656917882558,
        0.0130042187804768,    0.0133469623505606,    0.0136939095944053,
        0.0140450474496433,    0.0144003626961328,    0.0147598419564556,
        0.0151234716964208,    0.0154912382255742,    0.0158631276977137,
        0.0162391261114111,    0.0166192193105384,    0.0170033929848016,
        0.0173916326702791,    0.0177839237499660,    0.0181802514543249,
        0.0185806008618419,    0.0189849568995878,    0.0193933043437866,
        0.0198056278203877,    0.0202219118056452,    0.0206421406267025,
        0.0210662984621818,    0.0214943693427805,    0.0219263371518718,
        0.0223621856261119,    0.0228018983560520,    0.0232454587867564,
        0.0236928502184257,    0.0241440558070251,    0.0245990585649194,
        0.0250578413615119,    0.0255203869238896,    0.0259866778374735,
        0.0264566965466742,    0.0269304253555531,    0.0274078464284882,
        0.0278889417908459,    0.0283736933296579,    0.0288620827943025,
        0.0293540917971926,    0.0298497018144673,    0.0303488941866894,
        0.0308516501195484,    0.0313579506845676,    0.0318677768198167,
        0.0323811093306301,    0.0328979288903288,    0.0334182160409484,
        0.0339419511939719,    0.0344691146310666,    0.0349996865048273,
        0.0355336468395227,    0.0360709755318479,    0.0366116523516816,
        0.0371556569428468,    0.0377029688238784,    0.0382535673887932,
        0.0388074319078666,    0.0393645415284125,    0.0399248752755684,
        0.0404884120530855,    0.0410551306441227,    0.0416250097120453,
        0.0421980278012285,    0.0427741633378652,    0.0433533946307779,
        0.0439356998722359,    0.0445210571387761,    0.0451094443920280,
        0.0457008394795443,    0.0462952201356341,    0.0468925639822017,
        0.0474928485295888,    0.0480960511774216,    0.0487021492154613,
        0.0493111198244593,    0.0499229400770164,    0.0505375869384458,
        0.0511550372676407,    0.0517752678179451,    0.0523982552380294,
        0.0530239760727693,    0.0536524067641291,    0.0542835236520483,
        0.0549173029753330,    0.0555537208725497,    0.0561927533829244,
        0.0568343764472442,    0.0574785659087634,    0.0581252975141128,
        0.0587745469142131,    0.0594262896651914,    0.0600805012293013,
        0.0607371569758473,    0.0613962321821116,    0.0620577020342853,
        0.0627215416284023,    0.0633877259712770,    0.0640562299814455,
        0.0647270284901096,    0.0654000962420847,    0.0660754078967503,
        0.0667529380290042,    0.0674326611302200,    0.0681145516092070,
        0.0687985837931742,    0.0694847319286963,    0.0701729701826840,
        0.0708632726433560,    0.0715556133212147,    0.0722499661500250,
        0.0729463049877953,    0.0736446036177620,    0.0743448357493763,
        0.0750469750192942,    0.0757509949923690,    0.0764568691626467,
        0.0771645709543638,    0.0778740737229477,    0.0785853507560203,
        0.0792983752744033,    0.0800131204331265,    0.0807295593224387,
        0.0814476649688207,    0.0821674103360007,    0.0828887683259725,
        0.0836117117800154,    0.0843362134797171,    0.0850622461479980,
        0.0857897824501385,    0.0865187949948081,    0.0872492563350965,
        0.0879811389695470,    0.0887144153431922,    0.0894490578485910,
        0.0901850388268684,    0.0909223305687564,    0.0916609053156377,
        0.0924007352605906,    0.0931417925494357,    0.0938840492817850,
        0.0946274775120920,    0.0953720492507041,    0.0961177364649161,
        0.0968645110800259,    0.0976123449803913,    0.0983612100104886,
        0.0991110779759727,    0.0998619206447385,    0.1006137097479840,
        0.1013664169812742,    0.1021200140056074,    0.1028744724484814,
        0.1036297639049623,    0.1043858599387537,    0.1051427320832673,
        0.1059003518426946,    0.1066586906930798,    0.1074177200833938,
        0.1081774114366092,    0.1089377361507758,    0.1096986656000980,
        0.1104601711360119,    0.1112222240882646,    0.1119847957659932,
        0.1127478574588049,    0.1135113804378584,    0.1142753359569450,
        0.1150396952535712,    0.1158044295500416,    0.1165695100545420,
        0.1173349079622239,    0.1181005944562887,    0.1188665407090727,
        0.1196327178831324,    0.1203990971323301,    0.1211656496029204,
        0.1219323464346360,    0.1226991587617744,    0.1234660577142850,
        0.1242330144188557,    0.1250000000000000,    0.1257669855811443,
        0.1265339422857150,    0.1273008412382256,    0.1280676535653640,
        0.1288343503970796,    0.1296009028676699,    0.1303672821168676,
        0.1311334592909273,    0.1318994055437112,    0.1326650920377761,
        0.1334304899454580,    0.1341955704499584,    0.1349603047464288,
        0.1357246640430550,    0.1364886195621416,    0.1372521425411951,
        0.1380152042340068,    0.1387777759117354,    0.1395398288639881,
        0.1403013343999020,    0.1410622638492241,    0.1418225885633908,
        0.1425822799166061,    0.1433413093069202,    0.1440996481573054,
        0.1448572679167326,    0.1456141400612462,    0.1463702360950377,
        0.1471255275515186,    0.1478799859943926,    0.1486335830187258,
        0.1493862902520160,    0.1501380793552615,    0.1508889220240273,
        0.1516387899895114,    0.1523876550196087,    0.1531354889199741,
        0.1538822635350839,    0.1546279507492959,    0.1553725224879080,
        0.1561159507182150,    0.1568582074505643,    0.1575992647394094,
        0.1583390946843623,    0.1590776694312436,    0.1598149611731316,
        0.1605509421514090,    0.1612855846568078,    0.1620188610304530,
        0.1627507436649035,    0.1634812050051919,    0.1642102175498614,
        0.1649377538520020,    0.1656637865202829,    0.1663882882199845,
        0.1671112316740275,    0.1678325896639993,    0.1685523350311793,
        0.1692704406775613,    0.1699868795668735,    0.1707016247255967,
        0.1714146492439797,    0.1721259262770523,    0.1728354290456362,
        0.1735431308373533,    0.1742490050076310,    0.1749530249807058,
        0.1756551642506237,    0.1763553963822380,    0.1770536950122046,
        0.1777500338499750,    0.1784443866787852,    0.1791367273566440,
        0.1798270298173159,    0.1805152680713036,    0.1812014162068258,
        0.1818854483907930,    0.1825673388697800,    0.1832470619709957,
        0.1839245921032497,    0.1845999037579152,    0.1852729715098903,
        0.1859437700185545,    0.1866122740287230,    0.1872784583715977,
        0.1879422979657147,    0.1886037678178884,    0.1892628430241527,
        0.1899194987706987,    0.1905737103348086,    0.1912254530857868,
        0.1918747024858871,    0.1925214340912366,    0.1931656235527558,
        0.1938072466170756,    0.1944462791274502,    0.1950826970246670,
        0.1957164763479516,    0.1963475932358709,    0.1969760239272307,
        0.1976017447619706,    0.1982247321820549,    0.1988449627323592,
        0.1994624130615542,    0.2000770599229836,    0.2006888801755407,
        0.2012978507845387,    0.2019039488225783,    0.2025071514704112,
        0.2031074360177983,    0.2037047798643659,    0.2042991605204557,
        0.2048905556079720,    0.2054789428612239,    0.2060643001277641,
        0.2066466053692221,    0.2072258366621348,    0.2078019721987715,
        0.2083749902879547,    0.2089448693558773,    0.2095115879469145,
        0.2100751247244316,    0.2106354584715875,    0.2111925680921334,
        0.2117464326112067,    0.2122970311761216,    0.2128443430571531,
        0.2133883476483184,    0.2139290244681521,    0.2144663531604773,
        0.2150003134951727,    0.2155308853689333,    0.2160580488060281,
        0.2165817839590516,    0.2171020711096712,    0.2176188906693698,
        0.2181322231801832,    0.2186420493154324,    0.2191483498804516,
        0.2196511058133106,    0.2201502981855327,    0.2206459082028074,
        0.2211379172056974,    0.2216263066703421,    0.2221110582091541,
        0.2225921535715118,    0.2230695746444469,    0.2235433034533258,
        0.2240133221625265,    0.2244796130761104,    0.2249421586384882,
        0.2254009414350806,    0.2258559441929749,    0.2263071497815743,
        0.2267545412132436,    0.2271981016439479,    0.2276378143738881,
        0.2280736628481281,    0.2285056306572195,    0.2289337015378182,
        0.2293578593732975,    0.2297780881943547,    0.2301943721796123,
        0.2306066956562134,    0.2310150431004122,    0.2314193991381581,
        0.2318197485456751,    0.2322160762500340,    0.2326083673297209,
        0.2329966070151983,    0.2333807806894616,    0.2337608738885889,
        0.2341368723022862,    0.2345087617744258,    0.2348765283035792,
        0.2352401580435444,    0.2355996373038672,    0.2359549525503567,
        0.2363060904055947,    0.2366530376494394,    0.2369957812195231,
        0.2373343082117442,    0.2376686058807527,    0.2379986616404304,
        0.2383244630643644,    0.2386459978863153,    0.2389632540006787,
        0.2392762194629413,    0.2395848824901303,    0.2398892314612572,
        0.2401892549177552,    0.2404849415639108,    0.2407762802672889,
        0.2410632600591519,    0.2413458701348730,    0.2416240998543424,
        0.2418979387423685,    0.2421673764890719,    0.2424324029502737,
        0.2426930081478776,    0.2429491822702450,    0.2432009156725651,
        0.2434481988772176,    0.2436910225741296,    0.2439293776211260,
        0.2441632550442742,    0.2443926460382213,    0.2446175419665261,
        0.2448379343619839,    0.2450538149269457,    0.2452651755336302,
        0.2454720082244300,    0.2456743052122112,    0.2458720588806065,
        0.2460652617843022,    0.2462539066493180,    0.2464379863732815,
        0.2466174940256950,    0.2467924228481970,    0.2469627662548161,
        0.2471285178322193,    0.2472896713399534,    0.2474462207106801,
        0.2475981600504038,    0.2477454836386944,    0.2478881859289020,
        0.2480262615483661,    0.2481597052986176,    0.2482885121555748,
        0.2484126772697323,    0.2485321959663437,    0.2486470637455976,
        0.2487572762827871,    0.2488628294284725,    0.2489637192086374,
        0.2490599418248388,    0.2491514936543493,    0.2492383712502945,
        0.2493205713417819,    0.2493980908340246,    0.2494709268084575,
        0.2495390765228472,    0.2496025374113957,    0.2496613070848363,
        0.2497153833305240,    0.2497647641125186,    0.2498094475716618,
        0.2498494320256466,    0.2498847159690807,    0.2499152980735437,
        0.2499411771876366,    0.2499623523370255,    0.2499788227244779,
        0.2499905877298931,    0.2499976469103251,    0.2500000000000000,
        0.2499976469103251,    0.2499905877298931,    0.2499788227244779,
        0.2499623523370255,    0.2499411771876366,    0.2499152980735437,
        0.2498847159690807,    0.2498494320256466,    0.2498094475716618,
        0.2497647641125186,    0.2497153833305240,    0.2496613070848363,
        0.2496025374113957,    0.2495390765228472,    0.2494709268084575,
        0.2493980908340246,    0.2493205713417819,    0.2492383712502945,
        0.2491514936543493,    0.2490599418248388,    0.2489637192086374,
        0.2488628294284725,    0.2487572762827872,    0.2486470637455976,
        0.2485321959663437,    0.2484126772697323,    0.2482885121555748,
        0.2481597052986177,    0.2480262615483662,    0.2478881859289020,
        0.2477454836386944,    0.2475981600504038,    0.2474462207106801,
        0.2472896713399534,    0.2471285178322193,    0.2469627662548161,
        0.2467924228481970,    0.2466174940256950,    0.2464379863732815,
        0.2462539066493180,    0.2460652617843022,    0.2458720588806065,
        0.2456743052122112,    0.2454720082244300,    0.2452651755336302,
        0.2450538149269457,    0.2448379343619839,    0.2446175419665261,
        0.2443926460382214,    0.2441632550442742,    0.2439293776211260,
        0.2436910225741296,    0.2434481988772176,    0.2432009156725652,
        0.2429491822702450,    0.2426930081478776,    0.2424324029502737,
        0.2421673764890719,    0.2418979387423685,    0.2416240998543424,
        0.2413458701348730,    0.2410632600591520,    0.2407762802672889,
        0.2404849415639109,    0.2401892549177552,    0.2398892314612572,
        0.2395848824901303,    0.2392762194629413,    0.2389632540006787,
        0.2386459978863153,    0.2383244630643644,    0.2379986616404304,
        0.2376686058807528,    0.2373343082117443,    0.2369957812195231,
        0.2366530376494394,    0.2363060904055947,    0.2359549525503568,
        0.2355996373038672,    0.2352401580435444,    0.2348765283035792,
        0.2345087617744258,    0.2341368723022863,    0.2337608738885889,
        0.2333807806894616,    0.2329966070151984,    0.2326083673297209,
        0.2322160762500340,    0.2318197485456751,    0.2314193991381582,
        0.2310150431004122,    0.2306066956562134,    0.2301943721796123,
        0.2297780881943548,    0.2293578593732975,    0.2289337015378182,
        0.2285056306572195,    0.2280736628481282,    0.2276378143738881,
        0.2271981016439480,    0.2267545412132436,    0.2263071497815743,
        0.2258559441929749,    0.2254009414350806,    0.2249421586384882,
        0.2244796130761104,    0.2240133221625265,    0.2235433034533258,
        0.2230695746444469,    0.2225921535715118,    0.2221110582091541,
        0.2216263066703421,    0.2211379172056975,    0.2206459082028074,
        0.2201502981855327,    0.2196511058133106,    0.2191483498804516,
        0.2186420493154324,    0.2181322231801833,    0.2176188906693699,
        0.2171020711096713,    0.2165817839590516,    0.2160580488060282,
        0.2155308853689334,    0.2150003134951727,    0.2144663531604774,
        0.2139290244681521,    0.2133883476483185,    0.2128443430571532,
        0.2122970311761216,    0.2117464326112067,    0.2111925680921334,
        0.2106354584715875,    0.2100751247244317,    0.2095115879469145,
        0.2089448693558773,    0.2083749902879547,    0.2078019721987715,
        0.2072258366621348,    0.2066466053692221,    0.2060643001277640,
        0.2054789428612239,    0.2048905556079720,    0.2042991605204557,
        0.2037047798643659,    0.2031074360177983,    0.2025071514704112,
        0.2019039488225784,    0.2012978507845387,    0.2006888801755407,
        0.2000770599229837,    0.1994624130615542,    0.1988449627323593,
        0.1982247321820549,    0.1976017447619706,    0.1969760239272307,
        0.1963475932358709,    0.1957164763479517,    0.1950826970246671,
        0.1944462791274503,    0.1938072466170756,    0.1931656235527558,
        0.1925214340912366,    0.1918747024858872,    0.1912254530857869,
        0.1905737103348087,    0.1899194987706987,    0.1892628430241527,
        0.1886037678178884,    0.1879422979657148,    0.1872784583715977,
        0.1866122740287230,    0.1859437700185546,    0.1852729715098903,
        0.1845999037579153,    0.1839245921032497,    0.1832470619709958,
        0.1825673388697800,    0.1818854483907930,    0.1812014162068259,
        0.1805152680713037,    0.1798270298173160,    0.1791367273566440,
        0.1784443866787853,    0.1777500338499750,    0.1770536950122046,
        0.1763553963822380,    0.1756551642506238,    0.1749530249807058,
        0.1742490050076310,    0.1735431308373533,    0.1728354290456363,
        0.1721259262770523,    0.1714146492439797,    0.1707016247255968,
        0.1699868795668735,    0.1692704406775613,    0.1685523350311794,
        0.1678325896639994,    0.1671112316740275,    0.1663882882199846,
        0.1656637865202829,    0.1649377538520019,    0.1642102175498614,
        0.1634812050051919,    0.1627507436649036,    0.1620188610304530,
        0.1612855846568078,    0.1605509421514090,    0.1598149611731317,
        0.1590776694312436,    0.1583390946843623,    0.1575992647394095,
        0.1568582074505643,    0.1561159507182150,    0.1553725224879080,
        0.1546279507492960,    0.1538822635350839,    0.1531354889199741,
        0.1523876550196088,    0.1516387899895115,    0.1508889220240273,
        0.1501380793552615,    0.1493862902520161,    0.1486335830187258,
        0.1478799859943926,    0.1471255275515186,    0.1463702360950377,
        0.1456141400612462,    0.1448572679167327,    0.1440996481573055,
        0.1433413093069203,    0.1425822799166062,    0.1418225885633908,
        0.1410622638492242,    0.1403013343999020,    0.1395398288639881,
        0.1387777759117354,    0.1380152042340069,    0.1372521425411951,
        0.1364886195621416,    0.1357246640430550,    0.1349603047464288,
        0.1341955704499584,    0.1334304899454580,    0.1326650920377761,
        0.1318994055437112,    0.1311334592909273,    0.1303672821168676,
        0.1296009028676699,    0.1288343503970796,    0.1280676535653640,
        0.1273008412382257,    0.1265339422857151,    0.1257669855811443,
        0.1250000000000000,    0.1242330144188557,    0.1234660577142850,
        0.1226991587617744,    0.1219323464346360,    0.1211656496029205,
        0.1203990971323301,    0.1196327178831324,    0.1188665407090728,
        0.1181005944562888,    0.1173349079622239,    0.1165695100545420,
        0.1158044295500416,    0.1150396952535712,    0.1142753359569450,
        0.1135113804378584,    0.1127478574588050,    0.1119847957659932,
        0.1112222240882646,    0.1104601711360119,    0.1096986656000981,
        0.1089377361507758,    0.1081774114366092,    0.1074177200833939,
        0.1066586906930798,    0.1059003518426946,    0.1051427320832674,
        0.1043858599387538,    0.1036297639049623,    0.1028744724484814,
        0.1021200140056074,    0.1013664169812743,    0.1006137097479840,
        0.0998619206447385,    0.0991110779759727,    0.0983612100104886,
        0.0976123449803913,    0.0968645110800259,    0.0961177364649162,
        0.0953720492507041,    0.0946274775120920,    0.0938840492817850,
        0.0931417925494357,    0.0924007352605906,    0.0916609053156377,
        0.0909223305687564,    0.0901850388268683,    0.0894490578485910,
        0.0887144153431922,    0.0879811389695471,    0.0872492563350965,
        0.0865187949948082,    0.0857897824501386,    0.0850622461479981,
        0.0843362134797171,    0.0836117117800155,    0.0828887683259726,
        0.0821674103360007,    0.0814476649688207,    0.0807295593224387,
        0.0800131204331266,    0.0792983752744033,    0.0785853507560203,
        0.0778740737229478,    0.0771645709543637,    0.0764568691626467,
        0.0757509949923690,    0.0750469750192942,    0.0743448357493763,
        0.0736446036177620,    0.0729463049877954,    0.0722499661500251,
        0.0715556133212147,    0.0708632726433560,    0.0701729701826841,
        0.0694847319286963,    0.0687985837931742,    0.0681145516092070,
        0.0674326611302201,    0.0667529380290042,    0.0660754078967503,
        0.0654000962420848,    0.0647270284901097,    0.0640562299814455,
        0.0633877259712770,    0.0627215416284023,    0.0620577020342853,
        0.0613962321821116,    0.0607371569758473,    0.0600805012293014,
        0.0594262896651914,    0.0587745469142132,    0.0581252975141129,
        0.0574785659087634,    0.0568343764472442,    0.0561927533829244,
        0.0555537208725498,    0.0549173029753330,    0.0542835236520484,
        0.0536524067641291,    0.0530239760727694,    0.0523982552380294,
        0.0517752678179452,    0.0511550372676408,    0.0505375869384459,
        0.0499229400770164,    0.0493111198244593,    0.0487021492154614,
        0.0480960511774216,    0.0474928485295889,    0.0468925639822017,
        0.0462952201356342,    0.0457008394795443,    0.0451094443920280,
        0.0445210571387761,    0.0439356998722360,    0.0433533946307779,
        0.0427741633378652,    0.0421980278012286,    0.0416250097120453,
        0.0410551306441227,    0.0404884120530855,    0.0399248752755684,
        0.0393645415284124,    0.0388074319078666,    0.0382535673887933,
        0.0377029688238785,    0.0371556569428468,    0.0366116523516816,
        0.0360709755318480,    0.0355336468395226,    0.0349996865048273,
        0.0344691146310667,    0.0339419511939719,    0.0334182160409484,
        0.0328979288903288,    0.0323811093306301,    0.0318677768198168,
        0.0313579506845676,    0.0308516501195485,    0.0303488941866895,
        0.0298497018144673,    0.0293540917971926,    0.0288620827943026,
        0.0283736933296579,    0.0278889417908459,    0.0274078464284882,
        0.0269304253555531,    0.0264566965466743,    0.0259866778374735,
        0.0255203869238896,    0.0250578413615119,    0.0245990585649194,
        0.0241440558070251,    0.0236928502184257,    0.0232454587867565,
        0.0228018983560520,    0.0223621856261119,    0.0219263371518719,
        0.0214943693427806,    0.0210662984621818,    0.0206421406267025,
        0.0202219118056453,    0.0198056278203877,    0.0193933043437866,
        0.0189849568995879,    0.0185806008618419,    0.0181802514543249,
        0.0177839237499660,    0.0173916326702791,    0.0170033929848017,
        0.0166192193105384,    0.0162391261114111,    0.0158631276977138,
        0.0154912382255742,    0.0151234716964208,    0.0147598419564556,
        0.0144003626961328,    0.0140450474496433,    0.0136939095944053,
        0.0133469623505606,    0.0130042187804769,    0.0126656917882558,
        0.0123313941192473,    0.0120013383595696,    0.0116755369356356,
        0.0113540021136847,    0.0110367459993213,    0.0107237805370587,
        0.0104151175098697,    0.0101107685387428,    0.0098107450822448,
        0.0095150584360892,    0.0092237197327111,    0.0089367399408481,
        0.0086541298651271,    0.0083759001456576,    0.0081020612576316,
        0.0078326235109281,    0.0075675970497263,    0.0073069918521224,
        0.0070508177297550,    0.0067990843274349,    0.0065518011227823,
        0.0063089774258704,    0.0060706223788740,    0.0058367449557258,
        0.0056073539617787,    0.0053824580334739,    0.0051620656380161,
        0.0049461850730543,    0.0047348244663698,    0.0045279917755700,
        0.0043256947877888,    0.0041279411193935,    0.0039347382156978,
        0.0037460933506820,    0.0035620136267185,    0.0033825059743050,
        0.0032075771518030,    0.0030372337451839,    0.0028714821677807,
        0.0027103286600465,    0.0025537792893199,    0.0024018399495962,
        0.0022545163613056,    0.0021118140710980,    0.0019737384516339,
        0.0018402947013824,    0.0017114878444252,    0.0015873227302677,
        0.0014678040336563,    0.0013529362544024,    0.0012427237172129,
        0.0011371705715275,    0.0010362807913626,    0.0009400581751613,
        0.0008485063456507,    0.0007616287497055,    0.0006794286582181,
        0.0006019091659754,    0.0005290731915425,    0.0004609234771527,
        0.0003974625886043,    0.0003386929151637,    0.0002846166694760,
        0.0002352358874814,    0.0001905524283382,    0.0001505679743534,
        0.0001152840309193,    0.0000847019264563,    0.0000588228123634,
        0.0000376476629745,    0.0000211772755221,    0.0000094122701069,
        0.0000023530896749,
    };

    constexpr static std::array<float, 1024> modulator
    {
        -0.0650024414062500,    -0.0883483886718750,    -0.1159973144531250,
        -0.1404113769531250,    -0.1640625000000000,    -0.1813354492187500,
        -0.1908264160156250,    -0.1898498535156250,    -0.1769409179687500,
        -0.1592407226562500,    -0.1367492675781250,    -0.1125183105468750,
        -0.0921325683593750,    -0.0779113769531250,    -0.0723876953125000,
        -0.0755615234375000,    -0.0833435058593750,    -0.0942993164062500,
        -0.1020202636718750,    -0.1087036132812500,    -0.1057434082031250,
        -0.0987243652343750,    -0.0891723632812500,    -0.0797119140625000,
        -0.0708618164062500,    -0.0665893554687500,    -0.0641784667968750,
        -0.0611267089843750,    -0.0610351562500000,    -0.0656127929687500,
        -0.0683898925781250,    -0.0679321289062500,    -0.0610656738281250,
        -0.0530090332031250,    -0.0405883789062500,    -0.0252990722656250,
        -0.0075378417968750,    0.0116271972656250,    0.0304260253906250,
        0.0462951660156250,    0.0603942871093750,    0.0702514648437500,
        0.0772399902343750,    0.0810546875000000,    0.0828552246093750,
        0.0859069824218750,    0.0921630859375000,    0.1018066406250000,
        0.1144714355468750,    0.1298217773437500,    0.1430053710937500,
        0.1546325683593750,    0.1606750488281250,    0.1604309082031250,
        0.1541137695312500,    0.1436157226562500,    0.1296386718750000,
        0.1138916015625000,    0.0979309082031250,    0.0897521972656250,
        0.0835876464843750,    0.0798645019531250,    0.0770568847656250,
        0.0754089355468750,    0.0731811523437500,    0.0646362304687500,
        0.0525207519531250,    0.0415039062500000,    0.0299377441406250,
        0.0202636718750000,    0.0137634277343750,    0.0151367187500000,
        0.0202026367187500,    0.0256042480468750,    0.0325927734375000,
        0.0382690429687500,    0.0386962890625000,    0.0376586914062500,
        0.0280761718750000,    0.0164489746093750,    -0.0012512207031250,
        -0.0182189941406250,    -0.0386047363281250,    -0.0533447265625000,
        -0.0674133300781250,    -0.0769958496093750,    -0.0810241699218750,
        -0.0838317871093750,    -0.0838623046875000,    -0.0810546875000000,
        -0.0796508789062500,    -0.0802001953125000,    -0.0785522460937500,
        -0.0765075683593750,    -0.0783386230468750,    -0.0827331542968750,
        -0.0862731933593750,    -0.0822753906250000,    -0.0799255371093750,
        -0.0740356445312500,    -0.0701293945312500,    -0.0695495605468750,
        -0.0755920410156250,    -0.0898437500000000,    -0.1093750000000000,
        -0.1224670410156250,    -0.1217651367187500,    -0.1021118164062500,
        -0.0578308105468750,    0.0051574707031250,    0.0789184570312500,
        0.1513977050781250,    0.2110595703125000,    0.2529602050781250,
        0.2717895507812500,    0.2694396972656250,    0.2484436035156250,
        0.2216186523437500,    0.2017211914062500,    0.1925354003906250,
        0.1980285644531250,    0.2121582031250000,    0.2294311523437500,
        0.2415771484375000,    0.2381591796875000,    0.2158203125000000,
        0.1764221191406250,    0.1302795410156250,    0.0826110839843750,
        0.0474853515625000,    0.0284729003906250,    0.0285644531250000,
        0.0428466796875000,    0.0623474121093750,    0.0787963867187500,
        0.0935363769531250,    0.0966491699218750,    0.0926208496093750,
        0.0838317871093750,    0.0742797851562500,    0.0691528320312500,
        0.0661621093750000,    0.0638122558593750,    0.0600585937500000,
        0.0511474609375000,    0.0357055664062500,    0.0138244628906250,
        -0.0048828125000000,    -0.0173034667968750,    -0.0242309570312500,
        -0.0229187011718750,    -0.0150451660156250,    -0.0069885253906250,
        -0.0049743652343750,    -0.0143737792968750,    -0.0329895019531250,
        -0.0555114746093750,    -0.0830383300781250,    -0.1034851074218750,
        -0.1137695312500000,    -0.1081542968750000,    -0.0891723632812500,
        -0.0649108886718750,    -0.0397949218750000,    -0.0194091796875000,
        -0.0107727050781250,    -0.0163269042968750,    -0.0312194824218750,
        -0.0466613769531250,    -0.0539855957031250,    -0.0465698242187500,
        -0.0237426757812500,    0.0134277343750000,    0.0582275390625000,
        0.0980834960937500,    0.1209411621093750,    0.1270446777343750,
        0.1123352050781250,    0.0826416015625000,    0.0471801757812500,
        0.0151367187500000,    -0.0092468261718750,    -0.0216369628906250,
        -0.0264892578125000,    -0.0265808105468750,    -0.0272521972656250,
        -0.0298767089843750,    -0.0394897460937500,    -0.0576782226562500,
        -0.0791320800781250,    -0.0978088378906250,    -0.1116638183593750,
        -0.1172790527343750,    -0.1100769042968750,    -0.0963439941406250,
        -0.0722961425781250,    -0.0523681640625000,    -0.0351257324218750,
        -0.0248413085937500,    -0.0149536132812500,    -0.0089111328125000,
        -0.0044555664062500,    0.0008850097656250,    0.0064392089843750,
        0.0115966796875000,    0.0117492675781250,    0.0039367675781250,
        -0.0080261230468750,    -0.0256042480468750,    -0.0473327636718750,
        -0.0664367675781250,    -0.0801696777343750,    -0.0845642089843750,
        -0.0807800292968750,    -0.0727844238281250,    -0.0624389648437500,
        -0.0576782226562500,    -0.0578002929687500,    -0.0625000000000000,
        -0.0703735351562500,    -0.0803833007812500,    -0.0845336914062500,
        -0.0790100097656250,    -0.0640563964843750,    -0.0400390625000000,
        -0.0124206542968750,    0.0156860351562500,    0.0343322753906250,
        0.0432739257812500,    0.0423583984375000,    0.0301513671875000,
        0.0125122070312500,    -0.0043945312500000,    -0.0179138183593750,
        -0.0243835449218750,    -0.0233154296875000,    -0.0167541503906250,
        -0.0105285644531250,    -0.0082702636718750,    -0.0137939453125000,
        -0.0291748046875000,    -0.0532226562500000,    -0.0808105468750000,
        -0.1084594726562500,    -0.1300659179687500,    -0.1463623046875000,
        -0.1549682617187500,    -0.1591186523437500,    -0.1571960449218750,
        -0.1536254882812500,    -0.1509399414062500,    -0.1474914550781250,
        -0.1441040039062500,    -0.1380615234375000,    -0.1327819824218750,
        -0.1266784667968750,    -0.1193237304687500,    -0.1098022460937500,
        -0.1031188964843750,    -0.0992431640625000,    -0.0991821289062500,
        -0.1012268066406250,    -0.1082763671875000,    -0.1153869628906250,
        -0.1210327148437500,    -0.1235351562500000,    -0.1272583007812500,
        -0.1297912597656250,    -0.1380920410156250,    -0.1446533203125000,
        -0.1549072265625000,    -0.1719665527343750,    -0.1934509277343750,
        -0.2117614746093750,    -0.2257690429687500,    -0.2358398437500000,
        -0.2397460937500000,    -0.2369689941406250,    -0.2337951660156250,
        -0.2351379394531250,    -0.2496337890625000,    -0.2752685546875000,
        -0.3100280761718750,    -0.3497619628906250,    -0.3799438476562500,
        -0.3998413085937500,    -0.3969116210937500,    -0.3671264648437500,
        -0.3165588378906250,    -0.2507324218750000,    -0.1773681640625000,
        -0.1026916503906250,    -0.0379333496093750,    0.0079650878906250,
        0.0409240722656250,    0.0636901855468750,    0.0811462402343750,
        0.0981445312500000,    0.1240234375000000,    0.1633300781250000,
        0.2127990722656250,    0.2646789550781250,    0.3041381835937500,
        0.3338317871093750,    0.3450012207031250,    0.3350830078125000,
        0.3127441406250000,    0.2850341796875000,    0.2600097656250000,
        0.2410888671875000,    0.2304992675781250,    0.2297668457031250,
        0.2369995117187500,    0.2442626953125000,    0.2538146972656250,
        0.2576293945312500,    0.2565307617187500,    0.2563476562500000,
        0.2540588378906250,    0.2506408691406250,    0.2513732910156250,
        0.2557983398437500,    0.2558898925781250,    0.2546997070312500,
        0.2508239746093750,    0.2413330078125000,    0.2284240722656250,
        0.2102355957031250,    0.1943969726562500,    0.1850280761718750,
        0.1826171875000000,    0.1828613281250000,    0.1818847656250000,
        0.1808166503906250,    0.1698608398437500,    0.1480102539062500,
        0.1130981445312500,    0.0751037597656250,    0.0328674316406250,
        -0.0046386718750000,    -0.0318908691406250,    -0.0492553710937500,
        -0.0569458007812500,    -0.0585021972656250,    -0.0627136230468750,
        -0.0763549804687500,    -0.0948486328125000,    -0.1231384277343750,
        -0.1545104980468750,    -0.1833190917968750,    -0.1994018554687500,
        -0.2016601562500000,    -0.1924133300781250,    -0.1699829101562500,
        -0.1396789550781250,    -0.1116638183593750,    -0.0868835449218750,
        -0.0701599121093750,    -0.0689086914062500,    -0.0734558105468750,
        -0.0858154296875000,    -0.0981140136718750,    -0.1066589355468750,
        -0.1043701171875000,    -0.0966186523437500,    -0.0806274414062500,
        -0.0666198730468750,    -0.0584411621093750,    -0.0545654296875000,
        -0.0565795898437500,    -0.0618896484375000,    -0.0684204101562500,
        -0.0713500976562500,    -0.0696411132812500,    -0.0619812011718750,
        -0.0489501953125000,    -0.0368957519531250,    -0.0260009765625000,
        -0.0119934082031250,    -0.0015869140625000,    0.0102539062500000,
        0.0232849121093750,    0.0393371582031250,    0.0574645996093750,
        0.0773315429687500,    0.0928344726562500,    0.1088256835937500,
        0.1177368164062500,    0.1211547851562500,    0.1173095703125000,
        0.1118164062500000,    0.1067504882812500,    0.1049499511718750,
        0.1073608398437500,    0.1164245605468750,    0.1284484863281250,
        0.1415710449218750,    0.1496887207031250,    0.1494750976562500,
        0.1394042968750000,    0.1260986328125000,    0.1063232421875000,
        0.0867309570312500,    0.0699157714843750,    0.0619201660156250,
        0.0624389648437500,    0.0644226074218750,    0.0715026855468750,
        0.0735473632812500,    0.0720520019531250,    0.0652465820312500,
        0.0527954101562500,    0.0356140136718750,    0.0223693847656250,
        0.0127563476562500,    0.0083312988281250,    0.0106506347656250,
        0.0160217285156250,    0.0220642089843750,    0.0257568359375000,
        0.0260009765625000,    0.0187072753906250,    0.0057067871093750,
        -0.0086975097656250,    -0.0254516601562500,    -0.0432128906250000,
        -0.0577087402343750,    -0.0675048828125000,    -0.0761108398437500,
        -0.0817260742187500,    -0.0867004394531250,    -0.0919799804687500,
        -0.1040344238281250,    -0.1139526367187500,    -0.1213378906250000,
        -0.1227111816406250,    -0.1200256347656250,    -0.1062011718750000,
        -0.0874938964843750,    -0.0623168945312500,    -0.0384216308593750,
        -0.0189208984375000,    -0.0068054199218750,    0.0003967285156250,
        0.0060729980468750,    0.0012817382812500,    -0.0040588378906250,
        -0.0084228515625000,    -0.0068969726562500,    -0.0017395019531250,
        0.0112304687500000,    0.0346984863281250,    0.0642089843750000,
        0.0971374511718750,    0.1216125488281250,    0.1368103027343750,
        0.1484680175781250,    0.1535034179687500,    0.1497802734375000,
        0.1440124511718750,    0.1458740234375000,    0.1537170410156250,
        0.1599426269531250,    0.1677246093750000,    0.1760253906250000,
        0.1839599609375000,    0.1883850097656250,    0.1834106445312500,
        0.1729431152343750,    0.1555175781250000,    0.1383666992187500,
        0.1166992187500000,    0.0957336425781250,    0.0813903808593750,
        0.0749206542968750,    0.0692749023437500,    0.0660705566406250,
        0.0677795410156250,    0.0707397460937500,    0.0721130371093750,
        0.0693664550781250,    0.0683898925781250,    0.0660400390625000,
        0.0607299804687500,    0.0538024902343750,    0.0428466796875000,
        0.0326538085937500,    0.0225830078125000,    0.0097656250000000,
        -0.0043029785156250,    -0.0101928710937500,    -0.0135192871093750,
        -0.0165710449218750,    -0.0187683105468750,    -0.0175781250000000,
        -0.0175781250000000,    -0.0225219726562500,    -0.0330200195312500,
        -0.0434875488281250,    -0.0507202148437500,    -0.0530395507812500,
        -0.0514221191406250,    -0.0458068847656250,    -0.0312805175781250,
        -0.0122985839843750,    0.0025329589843750,    0.0095214843750000,
        0.0119018554687500,    0.0090637207031250,    0.0032348632812500,
        -0.0100708007812500,    -0.0194396972656250,    -0.0244445800781250,
        -0.0238342285156250,    -0.0173645019531250,    -0.0070190429687500,
        0.0066223144531250,    0.0219726562500000,    0.0296936035156250,
        0.0300598144531250,    0.0240783691406250,    0.0155029296875000,
        0.0039062500000000,    -0.0070800781250000,    -0.0144042968750000,
        -0.0150146484375000,    -0.0125427246093750,    -0.0147705078125000,
        -0.0160522460937500,    -0.0202331542968750,    -0.0276794433593750,
        -0.0383605957031250,    -0.0484924316406250,    -0.0576477050781250,
        -0.0610046386718750,    -0.0667419433593750,    -0.0710144042968750,
        -0.0678710937500000,    -0.0612792968750000,    -0.0540161132812500,
        -0.0496215820312500,    -0.0419616699218750,    -0.0356140136718750,
        -0.0283508300781250,    -0.0210571289062500,    -0.0193481445312500,
        -0.0146179199218750,    -0.0132446289062500,    -0.0143737792968750,
        -0.0222167968750000,    -0.0306091308593750,    -0.0387268066406250,
        -0.0487670898437500,    -0.0574645996093750,    -0.0637817382812500,
        -0.0644226074218750,    -0.0616760253906250,    -0.0596618652343750,
        -0.0557861328125000,    -0.0531616210937500,    -0.0530700683593750,
        -0.0562438964843750,    -0.0609130859375000,    -0.0610046386718750,
        -0.0592346191406250,    -0.0516967773437500,    -0.0407409667968750,
        -0.0241394042968750,    -0.0081481933593750,    0.0041503906250000,
        0.0110778808593750,    0.0118408203125000,    0.0073852539062500,
        -0.0004882812500000,    -0.0136108398437500,    -0.0254821777343750,
        -0.0353698730468750,    -0.0401306152343750,    -0.0427551269531250,
        -0.0432434082031250,    -0.0432739257812500,    -0.0435180664062500,
        -0.0431213378906250,    -0.0492248535156250,    -0.0573425292968750,
        -0.0691223144531250,    -0.0810546875000000,    -0.0950317382812500,
        -0.1052551269531250,    -0.1122131347656250,    -0.1185302734375000,
        -0.1206665039062500,    -0.1227722167968750,    -0.1226196289062500,
        -0.1206359863281250,    -0.1152343750000000,    -0.1112670898437500,
        -0.1057434082031250,    -0.1046447753906250,    -0.1041259765625000,
        -0.1075134277343750,    -0.1137390136718750,    -0.1217041015625000,
        -0.1303100585937500,    -0.1354370117187500,    -0.1385803222656250,
        -0.1420898437500000,    -0.1397399902343750,    -0.1389465332031250,
        -0.1380920410156250,    -0.1396484375000000,    -0.1435241699218750,
        -0.1514892578125000,    -0.1644287109375000,    -0.1769409179687500,
        -0.1918640136718750,    -0.2043762207031250,    -0.2152404785156250,
        -0.2208862304687500,    -0.2252807617187500,    -0.2238769531250000,
        -0.2255249023437500,    -0.2352294921875000,    -0.2594909667968750,
        -0.2914733886718750,    -0.3302917480468750,    -0.3695068359375000,
        -0.4008178710937500,    -0.4092102050781250,    -0.3907470703125000,
        -0.3480224609375000,    -0.2870178222656250,    -0.2163085937500000,
        -0.1362915039062500,    -0.0586547851562500,    0.0073852539062500,
        0.0490722656250000,    0.0807495117187500,    0.1018676757812500,
        0.1093750000000000,    0.1162109375000000,    0.1355590820312500,
        0.1684875488281250,    0.2137145996093750,    0.2615051269531250,
        0.3031616210937500,    0.3367309570312500,    0.3545837402343750,
        0.3518066406250000,    0.3310852050781250,    0.3021850585937500,
        0.2756958007812500,    0.2526550292968750,    0.2328491210937500,
        0.2281494140625000,    0.2327880859375000,    0.2430114746093750,
        0.2570800781250000,    0.2697143554687500,    0.2788696289062500,
        0.2839965820312500,    0.2805786132812500,    0.2688598632812500,
        0.2576904296875000,    0.2420959472656250,    0.2262268066406250,
        0.2125244140625000,    0.2012023925781250,    0.1942443847656250,
        0.1917419433593750,    0.1906738281250000,    0.1955566406250000,
        0.2018127441406250,    0.2060241699218750,    0.2057495117187500,
        0.1976013183593750,    0.1805114746093750,    0.1539306640625000,
        0.1198425292968750,    0.0823974609375000,    0.0450744628906250,
        0.0098571777343750,    -0.0148010253906250,    -0.0318298339843750,
        -0.0406494140625000,    -0.0447082519531250,    -0.0524902343750000,
        -0.0680236816406250,    -0.0913085937500000,    -0.1233520507812500,
        -0.1575012207031250,    -0.1885986328125000,    -0.2082824707031250,
        -0.2121582031250000,    -0.2008056640625000,    -0.1768188476562500,
        -0.1482543945312500,    -0.1167297363281250,    -0.0900268554687500,
        -0.0723876953125000,    -0.0681152343750000,    -0.0718078613281250,
        -0.0834350585937500,    -0.0971679687500000,    -0.1093750000000000,
        -0.1168518066406250,    -0.1137084960937500,    -0.1044006347656250,
        -0.0877990722656250,    -0.0700073242187500,    -0.0549316406250000,
        -0.0468750000000000,    -0.0431518554687500,    -0.0459594726562500,
        -0.0490112304687500,    -0.0532226562500000,    -0.0530395507812500,
        -0.0510864257812500,    -0.0462951660156250,    -0.0379333496093750,
        -0.0283813476562500,    -0.0154724121093750,    0.0024108886718750,
        0.0190734863281250,    0.0378723144531250,    0.0583801269531250,
        0.0750122070312500,    0.0875549316406250,    0.0944824218750000,
        0.0981140136718750,    0.0958862304687500,    0.0941772460937500,
        0.0936279296875000,    0.0965270996093750,    0.1036987304687500,
        0.1181335449218750,    0.1345214843750000,    0.1501464843750000,
        0.1625671386718750,    0.1708068847656250,    0.1691284179687500,
        0.1574096679687500,    0.1391296386718750,    0.1174926757812500,
        0.0978088378906250,    0.0821228027343750,    0.0707092285156250,
        0.0657348632812500,    0.0692443847656250,    0.0730590820312500,
        0.0765686035156250,    0.0742797851562500,    0.0661315917968750,
        0.0534362792968750,    0.0360107421875000,    0.0187072753906250,
        0.0075988769531250,    -0.0006103515625000,    -0.0003356933593750,
        0.0071716308593750,    0.0153808593750000,    0.0218505859375000,
        0.0268249511718750,    0.0277099609375000,    0.0214843750000000,
        0.0077819824218750,    -0.0071411132812500,    -0.0260009765625000,
        -0.0458679199218750,    -0.0649719238281250,    -0.0798645019531250,
        -0.0888671875000000,    -0.0943298339843750,    -0.0979919433593750,
        -0.1007080078125000,    -0.1058654785156250,    -0.1117858886718750,
        -0.1190795898437500,    -0.1215209960937500,    -0.1188049316406250,
        -0.1102600097656250,    -0.0959472656250000,    -0.0754089355468750,
        -0.0504455566406250,    -0.0241394042968750,    0.0001220703125000,
        0.0211791992187500,    0.0408935546875000,    0.0541992187500000,
        0.0665588378906250,    0.0730285644531250,    0.0813903808593750,
        0.0888977050781250,    0.0965270996093750,    0.1051330566406250,
        0.1135864257812500,    0.1187133789062500,    0.1216125488281250,
        0.1205749511718750,    0.1189880371093750,    0.1155700683593750,
        0.1160583496093750,    0.1165771484375000,    0.1200866699218750,
        0.1232299804687500,    0.1250000000000000,    0.1252441406250000,
        0.1188659667968750,    0.1136779785156250,    0.1072998046875000,
        0.1020202636718750,    0.0987854003906250,    0.1009216308593750,
        0.1039733886718750,    0.1087036132812500,    0.1111450195312500,
        0.1117248535156250,    0.1079101562500000,    0.0992431640625000,
        0.0867309570312500,    0.0762329101562500,    0.0682678222656250,
        0.0655517578125000,    0.0653381347656250,    0.0677795410156250,
        0.0708007812500000,    0.0697937011718750,    0.0645141601562500,
        0.0517883300781250,    0.0352478027343750,    0.0170593261718750,
        -0.0021362304687500,    -0.0190734863281250,    -0.0312805175781250,
        -0.0383605957031250,    -0.0405883789062500,    -0.0423278808593750,
        -0.0415954589843750,    -0.0417480468750000,    -0.0411682128906250,
        -0.0438232421875000,    -0.0455932617187500,    -0.0392456054687500,
        -0.0300903320312500,    -0.0155334472656250,    -0.0017700195312500,
        0.0151977539062500,    0.0288391113281250,    0.0373535156250000,
        0.0387573242187500,    0.0366210937500000,    0.0322875976562500,
        0.0278320312500000,    0.0228576660156250,    0.0182189941406250,
        0.0155944824218750,    0.0120544433593750,    0.0090942382812500,
        0.0021057128906250,    -0.0053710937500000,    -0.0153198242187500,
        -0.0252685546875000,    -0.0335083007812500,    -0.0360412597656250,
        -0.0360107421875000,    -0.0314941406250000,    -0.0253295898437500,
        -0.0184936523437500,    -0.0138244628906250,    -0.0148620605468750,
        -0.0177307128906250,    -0.0238647460937500,    -0.0315246582031250,
        -0.0387573242187500,    -0.0414428710937500,    -0.0422363281250000,
        -0.0384521484375000,    -0.0339660644531250,    -0.0301818847656250,
        -0.0281066894531250,    -0.0279541015625000,    -0.0319213867187500,
        -0.0374755859375000,    -0.0418090820312500,    -0.0466918945312500,
        -0.0465087890625000,    -0.0419921875000000,    -0.0380554199218750,
        -0.0344848632812500,    -0.0333862304687500,    -0.0356750488281250,
        -0.0405883789062500,    -0.0471496582031250,    -0.0546264648437500,
        -0.0604858398437500,    -0.0653381347656250,    -0.0672607421875000,
        -0.0649719238281250,    -0.0618896484375000,    -0.0603637695312500,
        -0.0585021972656250,    -0.0542297363281250,    -0.0518798828125000,
        -0.0509643554687500,    -0.0480346679687500,    -0.0455627441406250,
        -0.0377197265625000,    -0.0296020507812500,    -0.0175170898437500,
        -0.0067443847656250,    0.0052490234375000,    0.0110473632812500,
        0.0130310058593750,    0.0072631835937500,    -0.0000305175781250,
        -0.0077819824218750,    -0.0171813964843750,    -0.0305480957031250,
        -0.0387573242187500,    -0.0459289550781250,    -0.0537109375000000,
        -0.0612792968750000,    -0.0679931640625000,    -0.0727539062500000,
        -0.0779113769531250,    -0.0805053710937500,    -0.0849914550781250,
        -0.0861816406250000,    -0.0870056152343750,    -0.0833740234375000,
        -0.0821838378906250,    -0.0798950195312500,    -0.0806274414062500,
        -0.0838623046875000,    -0.0863952636718750,    -0.0895690917968750,
        -0.0917053222656250,    -0.0935974121093750,    -0.0934143066406250,
        -0.0913696289062500,    -0.0930786132812500,    -0.0931701660156250,
        -0.0997619628906250,    -0.1062927246093750,    -0.1176452636718750,
        -0.1312866210937500,    -0.1441040039062500,    -0.1543579101562500,
        -0.1632995605468750,    -0.1661682128906250,    -0.1670227050781250,
        -0.1596679687500000,    -0.1539611816406250,    -0.1484375000000000,
        -0.1473388671875000,    -0.1492614746093750,    -0.1553955078125000,
        -0.1650085449218750,    -0.1758728027343750,    -0.1828308105468750,
        -0.1901245117187500,    -0.1984252929687500,    -0.2087707519531250,
        -0.2216796875000000,    -0.2392272949218750,    -0.2673645019531250,
        -0.2959289550781250,    -0.3255004882812500,    -0.3492736816406250,
        -0.3600769042968750,    -0.3620605468750000,    -0.3492736816406250,
        -0.3203430175781250,    -0.2758483886718750,    -0.2227783203125000,
        -0.1652832031250000,    -0.1096496582031250,    -0.0597839355468750,
        -0.0120239257812500,    0.0283813476562500,    0.0610961914062500,
        0.0962524414062500,    0.1300048828125000,    0.1642456054687500,
        0.1997985839843750,    0.2315063476562500,    0.2574462890625000,
        0.2787170410156250,    0.2922668457031250,    0.2971496582031250,
        0.2960205078125000,    0.2925720214843750,    0.2886047363281250,
        0.2796630859375000,    0.2735290527343750,    0.2676391601562500,
        0.2644958496093750,    0.2607421875000000,    0.2562561035156250,
        0.2545776367187500,    0.2533264160156250,    0.2532043457031250,
        0.2556457519531250,    0.2544555664062500,    0.2537231445312500,
        0.2535705566406250,    0.2477416992187500,    0.2423400878906250,
        0.2305297851562500,    0.2167053222656250,    0.2053222656250000,
        0.1939392089843750,    0.1896972656250000,    0.1848754882812500,
        0.1855163574218750,    0.1909179687500000,    0.1928405761718750,
        0.1874084472656250,    0.1764221191406250,    0.1602783203125000,
        0.1346435546875000,    0.1040039062500000,    0.0708312988281250,
        0.0378112792968750,
    };

    constexpr static std::array<float, 1024> carrier
    {
        -0.0219726562500000,    -0.0194702148437500,    -0.0172729492187500,
        -0.0157775878906250,    -0.0144958496093750,    -0.0110778808593750,
        -0.0103149414062500,    -0.0145263671875000,    -0.0190124511718750,
        -0.0215759277343750,    -0.0225219726562500,    -0.0256347656250000,
        -0.0301513671875000,    -0.0328979492187500,    -0.0340270996093750,
        -0.0348815917968750,    -0.0356140136718750,    -0.0379028320312500,
        -0.0400390625000000,    -0.0418701171875000,    -0.0480346679687500,
        -0.0561218261718750,    -0.0627441406250000,    -0.0684814453125000,
        -0.0768127441406250,    -0.0858459472656250,    -0.0931701660156250,
        -0.0987548828125000,    -0.1044616699218750,    -0.1093139648437500,
        -0.1135559082031250,    -0.1156311035156250,    -0.1121215820312500,
        -0.1071472167968750,    -0.1028747558593750,    -0.0982360839843750,
        -0.0914916992187500,    -0.0821228027343750,    -0.0727844238281250,
        -0.0642700195312500,    -0.0548095703125000,    -0.0451660156250000,
        -0.0308532714843750,    -0.0152282714843750,    -0.0027160644531250,
        0.0078735351562500,    0.0148620605468750,    0.0177001953125000,
        0.0186157226562500,    0.0201416015625000,    0.0194091796875000,
        0.0159606933593750,    0.0108337402343750,    0.0073547363281250,
        0.0029602050781250,    -0.0030517578125000,    -0.0094299316406250,
        -0.0136413574218750,    -0.0157470703125000,    -0.0189514160156250,
        -0.0220336914062500,    -0.0245666503906250,    -0.0277099609375000,
        -0.0339050292968750,    -0.0396118164062500,    -0.0436401367187500,
        -0.0489807128906250,    -0.0564880371093750,    -0.0597534179687500,
        -0.0593261718750000,    -0.0587768554687500,    -0.0585937500000000,
        -0.0566101074218750,    -0.0512390136718750,    -0.0464172363281250,
        -0.0434265136718750,    -0.0412902832031250,    -0.0388793945312500,
        -0.0342712402343750,    -0.0290832519531250,    -0.0251464843750000,
        -0.0191650390625000,    -0.0093994140625000,    0.0011596679687500,
        0.0100097656250000,    0.0188903808593750,    0.0290222167968750,
        0.0387573242187500,    0.0490417480468750,    0.0580444335937500,
        0.0658264160156250,    0.0716247558593750,    0.0765075683593750,
        0.0819091796875000,    0.0872497558593750,    0.0915527343750000,
        0.0947570800781250,    0.0945434570312500,    0.0901489257812500,
        0.0862426757812500,    0.0808715820312500,    0.0750122070312500,
        0.0697021484375000,    0.0673522949218750,    0.0678100585937500,
        0.0671691894531250,    0.0667114257812500,    0.0657348632812500,
        0.0673828125000000,    0.0709533691406250,    0.0742187500000000,
        0.0770874023437500,    0.0819091796875000,    0.0880432128906250,
        0.0922851562500000,    0.0952758789062500,    0.1043090820312500,
        0.1183471679687500,    0.1275634765625000,    0.1309509277343750,
        0.1387939453125000,    0.1497497558593750,    0.1585998535156250,
        0.1668090820312500,    0.1713562011718750,    0.1725769042968750,
        0.1723937988281250,    0.1716308593750000,    0.1699829101562500,
        0.1673278808593750,    0.1646728515625000,    0.1581115722656250,
        0.1496582031250000,    0.1424560546875000,    0.1352233886718750,
        0.1241149902343750,    0.1125793457031250,    0.1025695800781250,
        0.0953674316406250,    0.0926208496093750,    0.0927124023437500,
        0.0927124023437500,    0.0939025878906250,    0.0994567871093750,
        0.1067199707031250,    0.1114196777343750,    0.1159057617187500,
        0.1247558593750000,    0.1348571777343750,    0.1421813964843750,
        0.1484680175781250,    0.1542968750000000,    0.1585693359375000,
        0.1616210937500000,    0.1600036621093750,    0.1526794433593750,
        0.1453247070312500,    0.1384582519531250,    0.1314392089843750,
        0.1220703125000000,    0.1109619140625000,    0.1009216308593750,
        0.0927734375000000,    0.0860900878906250,    0.0809631347656250,
        0.0755310058593750,    0.0698242187500000,    0.0640258789062500,
        0.0591125488281250,    0.0546264648437500,    0.0498962402343750,
        0.0456542968750000,    0.0417785644531250,    0.0393371582031250,
        0.0397338867187500,    0.0406494140625000,    0.0406799316406250,
        0.0427246093750000,    0.0454711914062500,    0.0476989746093750,
        0.0473937988281250,    0.0473327636718750,    0.0477905273437500,
        0.0478820800781250,    0.0483398437500000,    0.0427551269531250,
        0.0309448242187500,    0.0198364257812500,    0.0087280273437500,
        -0.0061950683593750,    -0.0244750976562500,    -0.0431213378906250,
        -0.0593872070312500,    -0.0755004882812500,    -0.0889587402343750,
        -0.1002502441406250,    -0.1121215820312500,    -0.1228637695312500,
        -0.1314697265625000,    -0.1381530761718750,    -0.1428527832031250,
        -0.1455383300781250,    -0.1468200683593750,    -0.1465759277343750,
        -0.1436767578125000,    -0.1402587890625000,    -0.1360778808593750,
        -0.1305847167968750,    -0.1244506835937500,    -0.1186523437500000,
        -0.1129760742187500,    -0.1052246093750000,    -0.0958862304687500,
        -0.0886840820312500,    -0.0825805664062500,    -0.0798950195312500,
        -0.0787048339843750,    -0.0767517089843750,    -0.0745544433593750,
        -0.0756835937500000,    -0.0807800292968750,    -0.0823059082031250,
        -0.0818786621093750,    -0.0838317871093750,    -0.0883789062500000,
        -0.0937194824218750,    -0.1011962890625000,    -0.1105651855468750,
        -0.1207275390625000,    -0.1291809082031250,    -0.1371154785156250,
        -0.1519470214843750,    -0.1688842773437500,    -0.1831665039062500,
        -0.1951599121093750,    -0.2068786621093750,    -0.2193908691406250,
        -0.2307128906250000,    -0.2404785156250000,    -0.2486572265625000,
        -0.2547912597656250,    -0.2595214843750000,    -0.2647705078125000,
        -0.2706298828125000,    -0.2748107910156250,    -0.2779846191406250,
        -0.2782592773437500,    -0.2766723632812500,    -0.2742309570312500,
        -0.2713928222656250,    -0.2656555175781250,    -0.2555847167968750,
        -0.2447814941406250,    -0.2342224121093750,    -0.2225646972656250,
        -0.2106018066406250,    -0.1980285644531250,    -0.1835327148437500,
        -0.1699523925781250,    -0.1586914062500000,    -0.1502990722656250,
        -0.1428833007812500,    -0.1350402832031250,    -0.1268005371093750,
        -0.1204833984375000,    -0.1198120117187500,    -0.1221923828125000,
        -0.1199645996093750,    -0.1170043945312500,    -0.1162414550781250,
        -0.1169433593750000,    -0.1175537109375000,    -0.1172180175781250,
        -0.1185302734375000,    -0.1206359863281250,    -0.1224060058593750,
        -0.1231384277343750,    -0.1242370605468750,    -0.1253662109375000,
        -0.1262512207031250,    -0.1229553222656250,    -0.1166381835937500,
        -0.1093750000000000,    -0.1002197265625000,    -0.0852966308593750,
        -0.0671386718750000,    -0.0518188476562500,    -0.0367126464843750,
        -0.0145263671875000,    0.0092468261718750,    0.0290832519531250,
        0.0451354980468750,    0.0626220703125000,    0.0839538574218750,
        0.1027832031250000,    0.1177978515625000,    0.1270446777343750,
        0.1350708007812500,    0.1449584960937500,    0.1520690917968750,
        0.1521606445312500,    0.1478881835937500,    0.1443481445312500,
        0.1398925781250000,    0.1327514648437500,    0.1246643066406250,
        0.1177673339843750,    0.1159667968750000,    0.1174621582031250,
        0.1195983886718750,    0.1220703125000000,    0.1301269531250000,
        0.1396179199218750,    0.1495361328125000,    0.1588745117187500,
        0.1703186035156250,    0.1805419921875000,    0.1894226074218750,
        0.1985778808593750,    0.2091064453125000,    0.2174987792968750,
        0.2245788574218750,    0.2291564941406250,    0.2323913574218750,
        0.2353820800781250,    0.2377624511718750,    0.2389221191406250,
        0.2386169433593750,    0.2404174804687500,    0.2444152832031250,
        0.2469177246093750,    0.2478332519531250,    0.2476806640625000,
        0.2473754882812500,    0.2501220703125000,    0.2531127929687500,
        0.2553405761718750,    0.2570190429687500,    0.2563781738281250,
        0.2554626464843750,    0.2537841796875000,    0.2530212402343750,
        0.2534484863281250,    0.2534484863281250,    0.2481384277343750,
        0.2424011230468750,    0.2406921386718750,    0.2402038574218750,
        0.2387390136718750,    0.2346496582031250,    0.2318420410156250,
        0.2290344238281250,    0.2267150878906250,    0.2210998535156250,
        0.2109069824218750,    0.2010192871093750,    0.1927795410156250,
        0.1835021972656250,    0.1720886230468750,    0.1606750488281250,
        0.1493530273437500,    0.1366271972656250,    0.1260681152343750,
        0.1172790527343750,    0.1092834472656250,    0.1015625000000000,
        0.0948486328125000,    0.0895080566406250,    0.0861816406250000,
        0.0843200683593750,    0.0825500488281250,    0.0813903808593750,
        0.0809020996093750,    0.0825500488281250,    0.0856018066406250,
        0.0887756347656250,    0.0922851562500000,    0.0954284667968750,
        0.0984802246093750,    0.0975036621093750,    0.0947875976562500,
        0.0934143066406250,    0.0923767089843750,    0.0917358398437500,
        0.0856018066406250,    0.0751342773437500,    0.0665283203125000,
        0.0552368164062500,    0.0409240722656250,    0.0270690917968750,
        0.0139160156250000,    -0.0005493164062500,    -0.0154724121093750,
        -0.0282897949218750,    -0.0403442382812500,    -0.0549621582031250,
        -0.0681762695312500,    -0.0795898437500000,    -0.0883483886718750,
        -0.0967102050781250,    -0.1047058105468750,    -0.1109619140625000,
        -0.1159973144531250,    -0.1224670410156250,    -0.1309204101562500,
        -0.1400756835937500,    -0.1488647460937500,    -0.1577758789062500,
        -0.1665039062500000,    -0.1725769042968750,    -0.1836547851562500,
        -0.1971435546875000,    -0.2093505859375000,    -0.2184143066406250,
        -0.2253417968750000,    -0.2339477539062500,    -0.2427368164062500,
        -0.2491455078125000,    -0.2502441406250000,    -0.2469177246093750,
        -0.2450866699218750,    -0.2453918457031250,    -0.2416687011718750,
        -0.2348022460937500,    -0.2284545898437500,    -0.2244873046875000,
        -0.2206420898437500,    -0.2165222167968750,    -0.2128906250000000,
        -0.2096557617187500,    -0.2085571289062500,    -0.2080078125000000,
        -0.2071838378906250,    -0.2067565917968750,    -0.2105102539062500,
        -0.2129516601562500,    -0.2107543945312500,    -0.2101745605468750,
        -0.2109069824218750,    -0.2115783691406250,    -0.2117614746093750,
        -0.2099304199218750,    -0.2070312500000000,    -0.2045898437500000,
        -0.2024841308593750,    -0.2017211914062500,    -0.2000427246093750,
        -0.1979980468750000,    -0.1958618164062500,    -0.1898803710937500,
        -0.1826171875000000,    -0.1790466308593750,    -0.1769409179687500,
        -0.1678161621093750,    -0.1557922363281250,    -0.1468200683593750,
        -0.1416625976562500,    -0.1313171386718750,    -0.1190795898437500,
        -0.1092224121093750,    -0.0989990234375000,    -0.0880737304687500,
        -0.0812072753906250,    -0.0765686035156250,    -0.0764465332031250,
        -0.0772705078125000,    -0.0792236328125000,    -0.0826110839843750,
        -0.0921630859375000,    -0.1021728515625000,    -0.1102905273437500,
        -0.1166992187500000,    -0.1206665039062500,    -0.1241149902343750,
        -0.1254882812500000,    -0.1258850097656250,    -0.1197814941406250,
        -0.1092834472656250,    -0.0996093750000000,    -0.0888061523437500,
        -0.0749206542968750,    -0.0609130859375000,    -0.0462341308593750,
        -0.0304870605468750,    -0.0145874023437500,    -0.0013732910156250,
        0.0091552734375000,    0.0200195312500000,    0.0314331054687500,
        0.0413818359375000,    0.0485534667968750,    0.0556945800781250,
        0.0630493164062500,    0.0690612792968750,    0.0732116699218750,
        0.0746459960937500,    0.0753173828125000,    0.0762023925781250,
        0.0757141113281250,    0.0738830566406250,    0.0715942382812500,
        0.0700378417968750,    0.0686340332031250,    0.0664367675781250,
        0.0642395019531250,    0.0626525878906250,    0.0606384277343750,
        0.0609130859375000,    0.0622863769531250,    0.0641174316406250,
        0.0661315917968750,    0.0705261230468750,    0.0773315429687500,
        0.0840454101562500,    0.0928344726562500,    0.1041564941406250,
        0.1132507324218750,    0.1235961914062500,    0.1366577148437500,
        0.1474914550781250,    0.1565856933593750,    0.1614379882812500,
        0.1648864746093750,    0.1695556640625000,    0.1727905273437500,
        0.1739807128906250,    0.1711730957031250,    0.1680908203125000,
        0.1643676757812500,    0.1599426269531250,    0.1547851562500000,
        0.1498107910156250,    0.1459350585937500,    0.1421813964843750,
        0.1383056640625000,    0.1345214843750000,    0.1312866210937500,
        0.1290893554687500,    0.1292114257812500,    0.1304016113281250,
        0.1310729980468750,    0.1309814453125000,    0.1318054199218750,
        0.1345825195312500,    0.1372985839843750,    0.1398315429687500,
        0.1416625976562500,    0.1434326171875000,    0.1506347656250000,
        0.1616821289062500,    0.1712341308593750,    0.1785888671875000,
        0.1822204589843750,    0.1844787597656250,    0.1862792968750000,
        0.1872253417968750,    0.1816711425781250,    0.1719055175781250,
        0.1643676757812500,    0.1595764160156250,    0.1515502929687500,
        0.1428527832031250,    0.1350402832031250,    0.1282958984375000,
        0.1230468750000000,    0.1186218261718750,    0.1156005859375000,
        0.1115722656250000,    0.1062927246093750,    0.0991821289062500,
        0.0923156738281250,    0.0833435058593750,    0.0727539062500000,
        0.0621948242187500,    0.0502319335937500,    0.0376281738281250,
        0.0247497558593750,    0.0146179199218750,    0.0056457519531250,
        -0.0064086914062500,    -0.0181884765625000,    -0.0284423828125000,
        -0.0361938476562500,    -0.0434265136718750,    -0.0510253906250000,
        -0.0571594238281250,    -0.0620422363281250,    -0.0623168945312500,
        -0.0607299804687500,    -0.0597229003906250,    -0.0583190917968750,
        -0.0504760742187500,    -0.0410156250000000,    -0.0325622558593750,
        -0.0240173339843750,    -0.0165405273437500,    -0.0110168457031250,
        -0.0066833496093750,    -0.0062866210937500,    -0.0054626464843750,
        -0.0036926269531250,    -0.0017395019531250,    -0.0020141601562500,
        -0.0029907226562500,    -0.0057983398437500,    -0.0107116699218750,
        -0.0181274414062500,    -0.0259704589843750,    -0.0317382812500000,
        -0.0386352539062500,    -0.0492248535156250,    -0.0593261718750000,
        -0.0673217773437500,    -0.0733947753906250,    -0.0822753906250000,
        -0.0933837890625000,    -0.1031188964843750,    -0.1088562011718750,
        -0.1089782714843750,    -0.1081848144531250,    -0.1081848144531250,
        -0.1011047363281250,    -0.0920410156250000,    -0.0847778320312500,
        -0.0760192871093750,    -0.0610656738281250,    -0.0453796386718750,
        -0.0335083007812500,    -0.0223083496093750,    -0.0115661621093750,
        -0.0042419433593750,    0.0012817382812500,    0.0038757324218750,
        0.0031433105468750,    0.0009155273437500,    -0.0045776367187500,
        -0.0137329101562500,    -0.0258483886718750,    -0.0370178222656250,
        -0.0463867187500000,    -0.0567626953125000,    -0.0665588378906250,
        -0.0747375488281250,    -0.0809020996093750,    -0.0850219726562500,
        -0.0895385742187500,    -0.0957641601562500,    -0.0981140136718750,
        -0.0948486328125000,    -0.0901794433593750,    -0.0889282226562500,
        -0.0878295898437500,    -0.0847473144531250,    -0.0809631347656250,
        -0.0780334472656250,    -0.0739440917968750,    -0.0679321289062500,
        -0.0621032714843750,    -0.0570068359375000,    -0.0516357421875000,
        -0.0401916503906250,    -0.0275268554687500,    -0.0158691406250000,
        -0.0076904296875000,    -0.0027160644531250,    0.0019836425781250,
        0.0090637207031250,    0.0146179199218750,    0.0172424316406250,
        0.0191955566406250,    0.0190734863281250,    0.0175170898437500,
        0.0162658691406250,    0.0146789550781250,    0.0128173828125000,
        0.0099792480468750,    0.0043334960937500,    -0.0018310546875000,
        -0.0063171386718750,    -0.0087890625000000,    -0.0122985839843750,
        -0.0199890136718750,    -0.0253601074218750,    -0.0268554687500000,
        -0.0277404785156250,    -0.0276794433593750,    -0.0310974121093750,
        -0.0371093750000000,    -0.0422973632812500,    -0.0465698242187500,
        -0.0514831542968750,    -0.0581054687500000,    -0.0646667480468750,
        -0.0697631835937500,    -0.0750427246093750,    -0.0802612304687500,
        -0.0820312500000000,    -0.0817871093750000,    -0.0825500488281250,
        -0.0829162597656250,    -0.0826721191406250,    -0.0774536132812500,
        -0.0692443847656250,    -0.0619506835937500,    -0.0552368164062500,
        -0.0505676269531250,    -0.0447082519531250,    -0.0344543457031250,
        -0.0247802734375000,    -0.0173950195312500,    -0.0133972167968750,
        -0.0104370117187500,    -0.0094604492187500,    -0.0083312988281250,
        -0.0080871582031250,    -0.0076599121093750,    -0.0079345703125000,
        -0.0064697265625000,    -0.0046386718750000,    -0.0033264160156250,
        -0.0025939941406250,    -0.0043945312500000,    -0.0068664550781250,
        -0.0097351074218750,    -0.0188293457031250,    -0.0314331054687500,
        -0.0416259765625000,    -0.0497131347656250,    -0.0585632324218750,
        -0.0668945312500000,    -0.0739440917968750,    -0.0776672363281250,
        -0.0758056640625000,    -0.0717468261718750,    -0.0680541992187500,
        -0.0649719238281250,    -0.0647583007812500,    -0.0625000000000000,
        -0.0564880371093750,    -0.0520019531250000,    -0.0513000488281250,
        -0.0526428222656250,    -0.0500793457031250,    -0.0468139648437500,
        -0.0480957031250000,    -0.0502624511718750,    -0.0524597167968750,
        -0.0541992187500000,    -0.0555419921875000,    -0.0563354492187500,
        -0.0565795898437500,    -0.0572509765625000,    -0.0588684082031250,
        -0.0610656738281250,    -0.0619506835937500,    -0.0589294433593750,
        -0.0552978515625000,    -0.0511169433593750,    -0.0445556640625000,
        -0.0320129394531250,    -0.0192260742187500,    -0.0092163085937500,
        -0.0002136230468750,    0.0083618164062500,    0.0159301757812500,
        0.0215148925781250,    0.0248413085937500,    0.0269470214843750,
        0.0309448242187500,    0.0339355468750000,    0.0364685058593750,
        0.0381774902343750,    0.0402221679687500,    0.0480651855468750,
        0.0534362792968750,    0.0534362792968750,    0.0513305664062500,
        0.0504760742187500,    0.0502014160156250,    0.0498046875000000,
        0.0498352050781250,    0.0493469238281250,    0.0494995117187500,
        0.0494384765625000,    0.0493469238281250,    0.0510253906250000,
        0.0565185546875000,    0.0625915527343750,    0.0668945312500000,
        0.0751037597656250,    0.0888671875000000,    0.1021423339843750,
        0.1125183105468750,    0.1238403320312500,    0.1379089355468750,
        0.1502075195312500,    0.1600952148437500,    0.1697082519531250,
        0.1783447265625000,    0.1828308105468750,    0.1864624023437500,
        0.1878967285156250,    0.1885375976562500,    0.1867675781250000,
        0.1788024902343750,    0.1683044433593750,    0.1583862304687500,
        0.1504211425781250,    0.1401977539062500,    0.1279296875000000,
        0.1172790527343750,    0.1082153320312500,    0.1006774902343750,
        0.0937194824218750,    0.0887145996093750,    0.0845947265625000,
        0.0837402343750000,    0.0859069824218750,    0.0889587402343750,
        0.0937805175781250,    0.1003723144531250,    0.1087341308593750,
        0.1154479980468750,    0.1211547851562500,    0.1301879882812500,
        0.1405944824218750,    0.1491699218750000,    0.1571655273437500,
        0.1654968261718750,    0.1714782714843750,    0.1756896972656250,
        0.1787109375000000,    0.1807556152343750,    0.1824340820312500,
        0.1805725097656250,    0.1753845214843750,    0.1687622070312500,
        0.1634521484375000,    0.1584167480468750,    0.1464538574218750,
        0.1316223144531250,    0.1185607910156250,    0.1083984375000000,
        0.0998840332031250,    0.0918579101562500,    0.0826416015625000,
        0.0750122070312500,    0.0689392089843750,    0.0646972656250000,
        0.0592651367187500,    0.0530700683593750,    0.0495605468750000,
        0.0470581054687500,    0.0458679199218750,    0.0448608398437500,
        0.0425415039062500,    0.0390625000000000,    0.0356445312500000,
        0.0319213867187500,    0.0271301269531250,    0.0207824707031250,
        0.0148925781250000,    0.0082397460937500,    0.0020751953125000,
        -0.0027465820312500,    -0.0081481933593750,    -0.0153198242187500,
        -0.0223999023437500,    -0.0279235839843750,    -0.0328674316406250,
        -0.0399169921875000,    -0.0480041503906250,    -0.0537719726562500,
        -0.0592041015625000,    -0.0636901855468750,    -0.0699157714843750,
        -0.0769653320312500,    -0.0834655761718750,    -0.0908813476562500,
        -0.0979003906250000,    -0.1039123535156250,    -0.1093139648437500,
        -0.1142578125000000,    -0.1172790527343750,    -0.1200256347656250,
        -0.1195983886718750,    -0.1144104003906250,    -0.1082458496093750,
        -0.1028747558593750,    -0.1006774902343750,    -0.0969238281250000,
        -0.0913085937500000,    -0.0872497558593750,    -0.0889282226562500,
        -0.0927429199218750,    -0.0959777832031250,    -0.0995483398437500,
        -0.1049804687500000,    -0.1104125976562500,    -0.1148681640625000,
        -0.1203308105468750,    -0.1295471191406250,    -0.1373596191406250,
        -0.1443786621093750,    -0.1499938964843750,    -0.1600952148437500,
        -0.1720581054687500,    -0.1833801269531250,    -0.1966857910156250,
        -0.2082519531250000,    -0.2181701660156250,    -0.2307434082031250,
        -0.2461853027343750,    -0.2597351074218750,    -0.2699584960937500,
        -0.2784118652343750,    -0.2878723144531250,    -0.2957153320312500,
        -0.3017272949218750,    -0.3059387207031250,    -0.3092346191406250,
        -0.3078308105468750,    -0.3038635253906250,    -0.2978210449218750,
        -0.2897033691406250,    -0.2789916992187500,    -0.2617187500000000,
        -0.2402954101562500,    -0.2185974121093750,    -0.1992492675781250,
        -0.1841125488281250,    -0.1666259765625000,    -0.1472167968750000,
        -0.1309814453125000,    -0.1170654296875000,    -0.1075439453125000,
        -0.1023864746093750,    -0.1004028320312500,    -0.0990295410156250,
        -0.0984497070312500,    -0.0982055664062500,    -0.0992126464843750,
        -0.1057434082031250,    -0.1166381835937500,    -0.1267700195312500,
        -0.1350097656250000,    -0.1426391601562500,    -0.1499328613281250,
        -0.1556091308593750,    -0.1600952148437500,    -0.1624755859375000,
        -0.1624450683593750,    -0.1595153808593750,    -0.1564941406250000,
        -0.1500244140625000,    -0.1404724121093750,    -0.1304321289062500,
        -0.1121826171875000,    -0.0904235839843750,    -0.0711364746093750,
        -0.0558166503906250,    -0.0404052734375000,    -0.0187988281250000,
        0.0021667480468750,    0.0193176269531250,    0.0353088378906250,
        0.0515136718750000,    0.0664367675781250,    0.0789184570312500,
        0.0908508300781250,    0.1029357910156250,    0.1124572753906250,
        0.1202697753906250,    0.1242370605468750,    0.1256713867187500,
        0.1265563964843750,    0.1267089843750000,    0.1242675781250000,
        0.1203308105468750,    0.1169128417968750,    0.1141662597656250,
        0.1096191406250000,    0.1048583984375000,    0.1017456054687500,
        0.1005859375000000,    0.1012573242187500,    0.1015625000000000,
        0.1038513183593750,    0.1124877929687500,    0.1242370605468750,
        0.1340332031250000,    0.1416320800781250,    0.1506958007812500,
        0.1639099121093750,    0.1757812500000000,    0.1854858398437500,
        0.1947326660156250,    0.2066955566406250,    0.2213745117187500,
        0.2345581054687500,    0.2471618652343750,    0.2577819824218750,
        0.2659606933593750,    0.2750549316406250,    0.2813110351562500,
        0.2846984863281250,    0.2870178222656250,    0.2871704101562500,
        0.2810974121093750,    0.2728271484375000,    0.2650756835937500,
        0.2585449218750000,    0.2531738281250000,    0.2492370605468750,
        0.2461853027343750,    0.2431640625000000,    0.2408447265625000,
        0.2385253906250000,    0.2369079589843750,    0.2353515625000000,
        0.2343444824218750,    0.2327270507812500,    0.2322387695312500,
        0.2330322265625000,
    };




    arm_rfft_fast_instance_f32 fft, fft_conv;

    std::array<float, 2 * window_size> carrier_env, modulator_env;
    std::array<float, window_size> carrier_input, carrier_stfft, modulator_input, output, channel_fft;
#endif
    vocoder_attr attr;
};

}

#endif /* MODEL_VOCODER_VOCODER_HPP_ */
